<!doctype html>
<html lang="UFT-8">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="/static/bootstrap-dist/css/bootstrap.min.css?q={{appVer}}">
    <link rel="stylesheet" type="text/css" href="/static/css/cms_common.css?q={{appVer}}">
    <link rel="stylesheet" type="text/css" href="/static/css/cms.css?q={{appVer}}">
    <link rel="stylesheet" type="text/css" href="/static/jquery/jqModal-1.9.css?q={{appVer}}">
    <link rel="stylesheet" type="text/css" href="/static/jquery/jquery.simplemodal.confirm.css?q={{appVer}}">
    <link rel="stylesheet" type="text/css" href="/static/jquery-ui-1.10.3.custom/css/redmond/jquery-ui-1.10.3.custom.min.css?q={{appVer}}">
    <link rel="stylesheet" type="text/css" href="/static/css/TlibDragAndDropUpload.css?q={{appVer}}">
    <link rel="stylesheet" type="text/css" href="/static/jstree/themes/style.min.css?q={{appVer}}">
    <link rel="stylesheet" type="text/css" href="/static/jstree/themes/style.cms.css?q={{appVer}}">

    <script src="/static/jquery/jquery-1.10.2.min.js?q={{appVer}}" type="text/javascript"></script>
    <script src="/static/bootstrap-dist/js/bootstrap.min.js?q={{appVer}}" type="text/javascript"></script>
    <script src="/static/jquery-ui-1.10.3.custom/js/jquery-ui-1.10.3.custom.js?q={{appVer}}"></script>
    <script src="/static/jquery.blockUI/jquery.blockUI.js?q={{appVer}}" type="text/javascript"></script>
    <script src="/static/jquery/jqModal-1.9.js?q={{appVer}}" type="text/javascript"></script>
    <script src="/static/jquery/jqDnR.js?q={{appVer}}" type="text/javascript"></script>
    <script src="/static/jquery/jquery.simplemodal.js?q={{appVer}}" type="text/javascript"></script>
    <script src="/static/jquery/jquery.simplemodal.confirm.js?q={{appVer}}" type="text/javascript"></script>
    <script src="/static/js/TlibDragAndDropUploadFromDms.js?q={{appVer}}" type="text/javascript"></script>
    <script src="/static/js/cms-common.js?q={{appVer}}" type="text/javascript"></script>
    <script src="/static/js/cms.js?q={{appVer}}" type="text/javascript"></script>
    <script src="/static/jstree/jstree.min.js?q={{appVer}}" type="text/javascript"></script>


    <style type="text/css">
        html,body { margin: 0px; padding: 0px; }
        html { overflow: hidden; }
        body { overflow: hidden; }
        .main-content {
            overflow: auto;
        }
        table {
            font-size: 9pt !important;
        }
        table#headerTable {
            height: 100%;
        }
        .inputText {
            width: 100%;
            min-width: 150px;
            font-family: 'MS Gothic', Sans-serif;
        }
        .propertyLabel {
            width: 316px;
        }
        .propertyBtn {
            width: 44px;
        }
        .upload_file_drop_target {
            padding: 10px;
            border: 3px dashed #000080;
            virtical-align: middle;
            text-align: center;
            width: 315px !important;
        }

        .keyword_tree .jstree-anchor {
            display: inline-block;
            width: auto;
        }

        .screen-control {
            width: 96%;
        }
        .keyword_tree {
            border: 1px solid #999999;
            float: left;
            height: 160px;
            width: 300px;
            margin: 8px;
            overflow: auto;
        }
        .keyword_btn_div {
            float: left;
            vertical-align: middle;
            height: 145px;
        }
        .keyword_content {
            padding: 5px;
            float: left;
            margin: 8px;
            height: 160px;
            width: 550px;
            border: 1px solid #999999;
            overflow: auto;
        }
        .kw-anchor {
            display: inline-block;
            color: black;
            white-space: nowrap;
            padding: 0 4px 0 1px;
            margin: 0;
            vertical-align: top;
        }
        .kw-anchor, .kw-anchor:link, .kw-anchor:visited, .kw-anchor:hover, .kw-anchor:active {
            color: inherit;
            text-decoration: none;
        }
        .sel-keyword{
            background: #beebff;
            border-radius: 2px;
            box-shadow: inset 0 0 1px #999999;
        }
        div#headerArea
        {
            background-color: {% if is_edit_mode %} #363; {% else %} #393f4c; {% endif %}
            height: 4.05em;

        }
        div.file_upload {
            font-size: 12pt;
            font-weight: bold;
        }
        #property {
            width: 95%;
            border: 1px #444444 solid;
            margin-bottom: 10px;
            margin-right: 10px;
        }
        #property th {
            text-align: left;
            width: 95%;
            background: #bbbbff;
            border-bottom: 1px solid #999999;
            font-size: 16px;
            padding: 2px;
        }
        #property td {
            text-align: left;
            border-bottom: 1px solid #999999;
        }
        #property td.name { white-space: nowrap; }
        #property td.value { width: 70%; }
        button#file_upload_btn {
            width: 150px;
            padding: 5px;
            font-size: 12pt;
            cursor: pointer;
            color: #FFFFFF;
            border: 2px solid #000080;
            background-color: #6495ED;
        }
        #file_upload_drop_target {
            position: relative;
            background: #FFFFFF;
            z-index: 204;
            width: 100%;
            min-width: 800px;
            height: 100px;
            line-height: 22px;
            text-align: center;
            display: table-cell;
            vertical-align: middle;
            border: 3px dashed #000080;
        }
        .btn.btn-default{
            height: 25px;
        }
        /* jqModal用CSS */
        .jqmWindow {
            width: 500px !important;
            min-height: 600px !important;
            max-height: 80% !important;
        }
    </style>
    <title>{{ title }}</title>
</head>
<body>
    <div class="condtion">
        <div class="border"></div>
        <center>
            <h2>CMS : {{ form["db_name"] }}</h2>
            <h3><font color="green">System administration tools</font></h3> TOSHIBA : {{current_user.get_user_name()}}
        </center>
        <div class="border"></div>
        &nbsp;&gt;&nbsp;<a href="{{url_for('db_adm_index')}}?db_id={{ form['db_id'] }}">Main Menu</a>&nbsp;&gt; Batch Insert ({{ form['object_type_name'] }})
        <div class="border"></div>
        <br>
    </div>
    <center>

        <table id="datalist_header" class="datalist_headerC">
            <tr>
                <th class="title">Upload  Document List</th>
            </tr>
            <tr>
                <td class="function"><a href="javascript:void(0);" onclick="downloadTemplateFile()">Download Template File</a></td>
            </tr>

        </table>
        <br>
         <!--123-->
        <form action="" name="xls_file_form" id="xls_file_form" method="post" enctype="multipart/form-data">
            <span class="alert" ></span>
            <div id="confirm">
                <div class="header"><span>Confirm</span></div>
                <div class="message"></div>
                <div class="buttons">
                    <div class="no simplemodal-close">No</div>
                    <div class="yes">Yes</div>
                </div>
            </div>
            <div id="alert">
                <div class="header"><span>Alert</span></div>
                <div class="message"></div>
                <div class="buttons">
                    <div class="no simplemodal-close">OK</div>
                </div>
            </div>
            <br>
            <center>
                <table id="property">
                    <tbody>
                    <tr>
                        <th colspan="2" style="background: #bbbbff;">File Upload Form</th>
                    </tr>
                    <tr class="even">
                        <td class="name">File Name</td>
                        <td class="value">
                            <div id="uploaded_file" class="uploaded_file"></div>
                            <div id="file_upload_drop_target" draggable="true">
                                <div class="file_upload">Drop a file here</div>
                                <div>or</div>
                                <input type="file" style="display:none" id="file" name="file" multiple="multiple" accept=".xlsx" />
                                <button type="button" id="file_upload_btn">select a file</button>
                            </div>
                        </td>
                    </tr>
                    <tr class="odd">

                        <td class="name">Option</td>

                        <td class="value">
                            <div class="input-group">
                                <input type="checkbox" id="skip_null_check" name="skip_null_check" style="vertical-align:middle;margin-top: -1px;appearance:checkbox" value="1">
                                <label for="skip_null_check" style="vertical-align:middle;">Skip NULL check</label>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </center>
            <input type="hidden" name="db_id" id="db_id" value="{{ form['db_id'] }}" />
            <input type="hidden" name="object_type_id" id="object_type_id" value="{{form['object_type_id']}}"/>
            <!--<input type="hidden" name="func" id="func" value="check_upload_doc_list_form_data_for_upload_check">-->
            <input type="submit" name="submit_btn" value="Preview" class="btn btn-default" />
            <input type="button" name="cancel_btn" value="Cancel" class="btn btn-default" onclick="cancel_func()"/>
        </form>
    </center>
    <div class="border"></div>
    <form id="downloadForm" name="downloadForm" action="{{url_for('template_dl')}}" method="post">
        <input type="hidden" name="db_id" value="{{form['db_id']}}" />
        <input type="hidden" name="object_type_id" id="object_type_id" value="{{form['object_type_id']}}" />
    </form>

    <div class="jqmWindow" id="jqmWindow"></div>
    <script>
        // downloadTemplateFile
        function downloadTemplateFile() {
            var url = $("#downloadForm").attr("action");
            var sendOption = $("#downloadForm").serialize();
            msSaveOrOpenBlob(url, "POST", "しばらくお待ちください", "", "application/x-www-form-urlencoded", sendOption);
        }
        function cancel_func(){
            window.close();
        }

        var drop_file;
        $(document).ready(function () {
            $("#xls_file_form").submit(function () {
                var file = $("#file").val();
                if (file === "") {
                    alert_dlg("Error","please drop or select a Excel file!");
                    return false;
                }
                if (!file.endsWith(".xlsx")) {
                    alert_dlg("Error","you can only put a xlsx file!");
                    return false;
                }
            })
            tlib_init_drag_and_drop_upload();
            drop_file = tlib_drag_and_drop({
                elm_ids: {
                    div_id: 'file_upload_drop_target',
                    input_id: 'file',
                    button_id: 'file_upload_btn',
                    ul_form_id: 'xls_file_form',
                    ul_file_id: 'uploaded_file',
                    ul_filename: 'doc_list_filename'
                },
            });
            drop_file.on_ready();
        });

    </script>
</body>
</html>